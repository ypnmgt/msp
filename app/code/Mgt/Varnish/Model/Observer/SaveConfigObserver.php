<?php
 namespace Mgt\Varnish\Model\Observer; use Magento\Framework\Event\ObserverInterface; use Magento\Framework\Event\Observer; class SaveConfigObserver implements ObserverInterface { const FULL_PAGE_CACHE_STATUS_ENABLED = 1; const FULL_PAGE_CACHE_STATUS_DISABLED = 0; protected $config; protected $deploymentConfigWriter; protected $configValueFactory; protected $cachePurger; protected $cacheTypeList; public function __construct(\Mgt\Varnish\Model\Cache\Config $config, \Magento\Framework\App\DeploymentConfig\Writer $deploymentConfigWriter, \Magento\Framework\App\Config\ValueFactory $configValueFactory, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Magento\Framework\App\Cache\TypeListInterface $cacheTypeList) { goto D5049; D5049: $this->config = $config; goto C8de3; c8169: $this->configValueFactory = $configValueFactory; goto e0462; Ff4c9: $this->cacheTypeList = $cacheTypeList; goto Ea1c8; e0462: $this->cachePurger = $cachePurger; goto Ff4c9; C8de3: $this->deploymentConfigWriter = $deploymentConfigWriter; goto c8169; Ea1c8: } public function execute(Observer $observer) { $isVarnishEnabled = $this->config->isEnabled(); try { goto d5f25; Ffd91: $configValue->load(\Magento\PageCache\Model\Config::XML_PAGECACHE_TYPE, "\x70\x61\164\150"); goto f5770; B423d: c8680: goto b4c0c; e6890: F6b19: goto A030c; Fc876: if (!isset($cacheTypes["\146\x75\154\154\x5f\160\141\x67\x65"])) { goto c8680; } goto ae01c; Bec3c: $configValue->delete(); goto d1624; af843: c83aa: goto dda25; a7f4b: if (!$cacheTypes) { goto F6b19; } goto Ff08b; A1d5d: if (!$configValue->getId()) { goto B6aa3; } goto Bec3c; dda25: $this->cachePurger->sendPurgeRequest("\x2a"); goto ec42c; A030c: $this->deploymentConfigWriter->saveConfig($appEnvDataCacheTypes, true); goto a73d8; ca833: a7387: goto Aa6cd; d5f25: $configValue = $this->configValueFactory->create(); goto Ffd91; B851a: $configValue->save(); goto Fc876; f5770: $cacheTypes = $this->cacheTypeList->getTypes(); goto d4d56; B8cd4: df74e: goto e6890; b4c0c: c2f41: goto eb787; Aa6cd: $configValue->setPath(\Magento\PageCache\Model\Config::XML_PAGECACHE_TYPE); goto d8e07; ec42c: goto c2f41; goto ca833; B45bb: $cacheTypes["\x66\x75\x6c\154\x5f\160\x61\147\x65"]->setStatus(self::FULL_PAGE_CACHE_STATUS_DISABLED); goto af843; Ff08b: foreach ($cacheTypes as $cacheTypeKey => $cacheType) { $appEnvDataCacheTypes["\x61\160\x70\x5f\145\x6e\166"]["\x63\141\x63\x68\x65\x5f\164\x79\x70\145\x73"][$cacheTypeKey] = (int) $cacheType->getStatus(); d0d4d: } goto B8cd4; eb787: $appEnvDataCacheTypes = []; goto a7f4b; d4d56: if (true === $isVarnishEnabled) { goto a7387; } goto A1d5d; ae01c: $cacheTypes["\146\165\x6c\154\137\160\x61\147\145"]->setStatus(self::FULL_PAGE_CACHE_STATUS_ENABLED); goto B423d; d8e07: $configValue->setValue(\Magento\PageCache\Model\Config::VARNISH); goto B851a; d1624: B6aa3: goto b8df1; b8df1: if (!isset($cacheTypes["\x66\x75\x6c\x6c\x5f\160\141\x67\145"])) { goto c83aa; } goto B45bb; a73d8: } catch (\Exception $e) { throw new $e(); } } }
