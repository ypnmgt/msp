<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class MagentoBackendWhitelistedIps extends ConfigValue { protected function _afterLoad() { goto Ec33e; a62df: $magentoBackendWhitelistedIpv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV6); goto f569a; f569a: if (!(false === empty($magentoBackendWhitelistedIpv6))) { goto E11a6; } goto Dcf5b; B2efb: goto ab5dd; goto c92cc; ac2b8: $projectName = $this->getProjectName(); goto c987c; D191f: $value = ''; goto e2187; D298d: foreach ($magentoBackendWhitelistedIpv4 as $ip) { goto Ebf63; d61dd: c294c: goto e6db2; af1d1: C064a: goto d61dd; Da87f: $whitelistedIps[] = substr($ip, 0, -3); goto af1d1; Ebf63: if (!(substr($ip, -3) == "\x2f\63\62")) { goto C064a; } goto Da87f; e6db2: } goto Ff66e; c92cc: B4f8b: goto D7c2a; a7450: if (!(false === empty($magentoBackendWhitelistedIpv4))) { goto F23e3; } goto D298d; D17bc: da948: goto E2b2f; A04c4: $magentoBackendWhitelistedIpv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV4); goto a7450; Dcf5b: foreach ($magentoBackendWhitelistedIpv6 as $ip) { goto e79f9; D4439: $whitelistedIps[] = substr($ip, 0, -4); goto Ef951; Ef951: Fcdb7: goto E35eb; E35eb: Dc3dd: goto E4c41; e79f9: if (!(substr($ip, -4) == "\57\x31\62\70")) { goto Fcdb7; } goto D4439; E4c41: } goto D17bc; D7c2a: $value = $sessionConfigData["\x67\x72\157\165\160\163"]["\155\x61\147\x65\x6e\x74\157\x5f\142\141\143\153\x65\156\144"]["\x66\x69\145\154\144\x73"]["\167\x68\x69\x74\145\x6c\151\163\164\x65\144\x5f\151\x70\163"]["\166\x61\154\x75\145"]; goto d8968; Ef23c: $awsAccessKey = $this->getAwsAccessKey(); goto ac2b8; Ec33e: $sessionConfigData = $this->getSessionConfigData(); goto D191f; E2b2f: E11a6: goto bbe5f; aa9aa: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto A04c4; bbe5f: $value = implode(PHP_EOL, $whitelistedIps); goto D66e7; e2187: if (true === isset($sessionConfigData["\x67\162\x6f\x75\160\x73"]["\155\141\x67\145\x6e\164\x6f\137\x62\141\143\153\x65\x6e\x64"]["\x66\151\x65\x6c\x64\163"]["\167\x68\151\164\x65\x6c\151\163\164\145\x64\x5f\151\160\163"]["\x76\141\x6c\x75\x65"])) { goto B4f8b; } goto Ef23c; ed44e: $whitelistedIps = []; goto aa9aa; aec85: $this->setValue($value); goto b4e05; ffb35: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto A199d; A199d: $awsRegion = $this->getAwsRegion(); goto ed44e; d8968: ab5dd: goto aec85; B05a7: F23e3: goto a62df; Ff66e: Db3fc: goto B05a7; c987c: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto a9ea8; } goto ffb35; D66e7: a9ea8: goto B2efb; b4e05: } }
