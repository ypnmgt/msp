<?php
 namespace Mgt\Varnish\Model; class License { const MODULE_NAME = "\x4d\147\164\x5f\x56\141\x72\x6e\x69\x73\x68"; protected $dirReader; protected $domains = []; public function __construct() { $objectManager = $this->getObjectManager(); $this->dirReader = $objectManager->get("\x5c\x4d\141\147\x65\x6e\164\x6f\x5c\106\x72\141\155\x65\x77\157\162\153\134\x4d\157\144\165\154\145\x5c\x44\x69\x72\134\x52\145\x61\x64\145\x72"); } public function hasLicense($currentHost) { goto C6555; Fddf1: if (!(true === file_exists($licenseFile))) { goto F949f; } goto Aabf3; C6555: $hasLicense = false; goto c2066; d2e02: if (!(is_array($license) && $license["\x6d\x6f\x64\165\154\x65"] == self::MODULE_NAME && $isHostValid && (!$license["\x65\x78\x70\151\162\145\104\141\x74\145"] || $license["\145\170\160\x69\x72\145\104\x61\164\145"] && $expireDate->isLater(Zend_Date::now())))) { goto A78a4; } goto Dac31; Dbbae: $expireDate = new \Zend_Date(); goto b6e42; cf05a: F949f: goto D8e8f; Eb4f5: $isHostValid = $this->_isHostValid($currentHost, $license["\144\157\155\141\x69\156\163"]); goto d2e02; Dac31: $hasLicense = true; goto febd1; D8e8f: return $hasLicense; goto d63e4; d4835: e3a9e: goto Eb4f5; A2d67: $today = new \DateTime(); goto B620d; c2066: $licenseFile = $this->dirReader->getModuleDir('', self::MODULE_NAME) . "\57\x6c\x69\x63\x65\x6e\163\x65\x2e\x6d\x67\164"; goto Fddf1; Aabf3: eval(gzinflate(base64_decode(file_get_contents($licenseFile)))); goto Da0d4; B620d: if (!(isset($license["\145\x78\160\x69\x72\x65\104\141\x74\x65"]) && $license["\x65\170\160\151\162\145\104\x61\x74\x65"])) { goto e3a9e; } goto Dbbae; b6e42: $expireDate->setTimestamp($license["\x65\170\160\151\x72\145\x44\141\164\x65"]); goto d4835; febd1: A78a4: goto cf05a; Da0d4: $currentHost = str_replace("\x77\167\x77\56", '', $currentHost); goto A2d67; d63e4: } protected function _isHostValid($currentHost, array $domains) { goto C2e0f; C2e0f: $isHostValid = false; goto d9d65; d9d65: foreach ($domains as $domain) { goto Ddca6; A2214: goto Fbce0; goto F7e2d; F7e2d: ce027: goto D35f4; b0a92: $isHostValid = true; goto A2214; D35f4: E758b: goto d67b5; Ddca6: if (!strstr($currentHost, $domain)) { goto ce027; } goto b0a92; d67b5: } goto Ff404; Ff404: Fbce0: goto A8bb4; A8bb4: return $isHostValid; goto f0ce9; f0ce9: } public function getDomains() { goto c0d21; A030e: Fce08: goto Dc36e; c0d21: $domains = []; goto F0bf4; Dc36e: return $domains; goto e8c03; Ae8f2: if (!(true === file_exists($licenseFile))) { goto Fce08; } goto A2a3c; E2ffe: A99f3: goto A030e; A2a3c: eval(gzinflate(base64_decode(file_get_contents($licenseFile)))); goto D9eac; F0bf4: $licenseFile = $this->dirReader->getModuleDir('', self::MODULE_NAME) . "\57\x6c\151\143\x65\156\x73\x65\56\x6d\x67\x74"; goto Ae8f2; D9eac: if (!(isset($license["\144\157\155\x61\151\x6e\x73"]) && $license["\x64\x6f\x6d\141\x69\156\x73"])) { goto A99f3; } goto a59d1; a59d1: $domains = $license["\144\157\x6d\x61\x69\156\163"]; goto E2ffe; e8c03: } protected function getObjectManager() { $objectManager = \Magento\Framework\App\ObjectManager::getInstance(); return $objectManager; } }
