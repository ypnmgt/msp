<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class RateLimitWhitelistedIps extends ConfigValue { protected function _afterLoad() { goto E00bd; a55ff: if (!(false === empty($rateLimitWhitelistedIpv6))) { goto Ddcab; } goto c0b4a; c0b4a: foreach ($rateLimitWhitelistedIpv6 as $ip) { goto D5ec0; fc2d6: d345f: goto e2554; D5ec0: if (!(substr($ip, -4) == "\57\x31\x32\70")) { goto C514e; } goto b0476; b0476: $whitelistedIps[] = substr($ip, 0, -4); goto Abbea; Abbea: C514e: goto fc2d6; e2554: } goto f112b; F5566: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto d856c; f112b: B014b: goto F2626; b69d0: $projectName = $this->getProjectName(); goto Ac928; B9f00: C86f0: goto d68f1; Bc4eb: Ae77e: goto ca678; E00bd: $sessionConfigData = $this->getSessionConfigData(); goto a8f7e; Edb57: $whitelistedIps = []; goto F5566; a789f: foreach ($rateLimitWhitelistedIpv4 as $ip) { goto D197c; d9ce1: b1543: goto C6154; D197c: if (!(substr($ip, -3) == "\57\63\x32")) { goto ca25a; } goto d9c78; E06db: ca25a: goto d9ce1; d9c78: $whitelistedIps[] = substr($ip, 0, -3); goto E06db; C6154: } goto f9d42; f9d42: ff78a: goto Bc4eb; E209c: $this->setValue($value); goto B2a30; d856c: $rateLimitWhitelistedIpv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV4); goto D12c4; f01cd: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto d695d; a8f7e: $value = ''; goto e1b65; d68f1: $value = $sessionConfigData["\147\x72\157\165\x70\x73"]["\x72\x61\x74\x65\x5f\154\x69\x6d\x69\x74"]["\x66\151\145\x6c\144\x73"]["\167\150\151\164\x65\x6c\151\x73\x74\x65\144\x5f\x69\x70\163"]["\166\141\x6c\165\x65"]; goto b1ec6; B3086: $value = implode(PHP_EOL, $whitelistedIps); goto E2648; ca678: $rateLimitWhitelistedIpv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV6); goto a55ff; e1b65: if (true === isset($sessionConfigData["\147\162\x6f\165\160\x73"]["\162\x61\164\145\137\x6c\151\155\151\x74"]["\146\151\145\x6c\x64\x73"]["\x77\x68\151\164\145\x6c\x69\163\x74\145\144\137\151\160\x73"]["\x76\141\x6c\x75\x65"])) { goto C86f0; } goto B0a7c; D12c4: if (!(false === empty($rateLimitWhitelistedIpv4))) { goto Ae77e; } goto a789f; d695d: $awsRegion = $this->getAwsRegion(); goto Edb57; Ac928: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto F8750; } goto f01cd; c395a: goto E1a58; goto B9f00; B0a7c: $awsAccessKey = $this->getAwsAccessKey(); goto b69d0; F2626: Ddcab: goto B3086; b1ec6: E1a58: goto E209c; E2648: F8750: goto c395a; B2a30: } }
